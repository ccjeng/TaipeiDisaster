function isEmpty(e){return"undefined"==typeof e||!e||0===e.length}!function(){function e(){function e(e){r=e.coords.latitude,c=e.coords.longitude,a()}function o(e){var a={0:"不明原因錯誤",1:"使用者拒絕提供位置資訊",2:"無法取得位置資訊",3:"位置查詢逾時"};alert(a[e.code]),console.log("code="+e.code+" "+e.message)}if(navigator.geolocation){var t={enableAcuracy:!1,maximumAge:0,timeout:6e5};navigator.geolocation.getCurrentPosition(e,o,t)}else alert("此瀏覽器不支援地理定位功能!")}function a(){var e=new GeolocationMarker(o);e.setCircleOptions({fillColor:"#808080"}),google.maps.event.addListenerOnce(e,"position_changed",function(){o.setCenter(this.getPosition()),o.fitBounds(this.getBounds())}),google.maps.event.addListener(e,"geolocation_error",function(e){alert("無法取得位置資訊. "+e.message)}),e.setMap(o)}var o,t=angular.module("app",[]),n=25.06464,s=121.55676,r=n,c=s;t.controller("GetDisasterSummary",["$scope","$http",function(a,t){a.orderByField="CaseTime",a.reverseSort=!0;var n={center:new google.maps.LatLng(r,c),zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP};e(),o=new google.maps.Map(document.getElementById("map"),n),a.map=o,a.markers=[];var s=new google.maps.InfoWindow,l=function(e){var o,t,n="true"===e.CaseComplete?"80e516":"FE7569";switch(e.PName){case"路樹災情":t="樹";break;case"民生、基礎設施災情":t="民";break;case"建物毀損":t="建";break;case"廣告招牌災情":t="廣";break;case"積淹水災情":t="水";break;case"其他災情":t="其";break;case"環境污染":t="污";break;case"土石災情":t="土";break;case"道路、隧道災情":t="路";break;case"鐵路、高鐵及捷運災情":t="運";break;case"車輛及交通事故":t="車";break;default:t="危"}"true"===e.CaseComplete?(t="復",o=new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_spin&chld=0.7|0|"+n+"|15|b|"+t)):o=new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_spin&chld=0.7|20|"+n+"|15|b|"+t);var i=new google.maps.Marker({map:a.map,position:new google.maps.LatLng(e.Wgs84Y,e.Wgs84X),title:e.PName+" - "+e.Name,pid:e["-diffgr:id"].toLowerCase(),icon:o,pinColor:n});i.content='<div class="infoWindowContent">發生時間：'+e.CaseTime+"</br>災情地點："+e.CaseLocationDescription+"</br>災情描述："+e.CaseDescription+"</div>",google.maps.event.addListener(i,"click",function(){s.setContent("<h3>"+i.title+"</h3>"+i.content),s.open(a.map,i)}),a.markers.push(i)};a.total={"路樹災情":0,"民生、基礎設施災情":0,"建物毀損":0,"廣告招牌災情":0,"積淹水災情":0,"其他災情":0,"環境污染":0,"土石災情":0,"道路、隧道災情":0,"水利設施災情":0,"鐵路、高鐵及捷運災情":0,"車輛及交通事故":0},a.doneTotal={"路樹災情":0,"民生、基礎設施災情":0,"建物毀損":0,"廣告招牌災情":0,"積淹水災情":0,"其他災情":0,"環境污染":0,"土石災情":0,"道路、隧道災情":0,"水利設施災情":0,"鐵路、高鐵及捷運災情":0,"車輛及交通事故":0},t.get("https://tcgbusfs.blob.core.windows.net/blobfs/GetDisasterSummary.json").success(function(e,o,t,n){d=e.DataSet["diffgr:diffgram"].NewDataSet.CASE_SUMMARY,a.dataTime=e.DataSet["-date"],a.cases=d;var s=0,r=0,c=0;for(i=0;i<d.length;i++)l(d[i]),"true"===d[i].CaseComplete?(s+=1,"路樹災情"===d[i].PName&&(a.doneTotal["路樹災情"]+=1),"民生、基礎設施災情"===d[i].PName&&(a.doneTotal["民生、基礎設施災情"]+=1),"建物毀損"===d[i].PName&&(a.doneTotal["建物毀損"]+=1),"廣告招牌災情"===d[i].PName&&(a.doneTotal["廣告招牌災情"]+=1),"積淹水災情"===d[i].PName&&(a.doneTotal["積淹水災情"]+=1),"其他災情"===d[i].PName&&(a.doneTotal["其他災情"]+=1),"土石災情"===d[i].PName&&(a.doneTotal["土石災情"]+=1),"道路、隧道災情"===d[i].PName&&(a.doneTotal["道路、隧道災情"]+=1),"水利設施災害"===d[i].PName&&(a.doneTotal["水利設施災情"]+=1),"鐵路、高鐵及捷運災情"===d[i].PName&&(a.doneTotal["鐵路、高鐵及捷運災情"]+=1),"車輛及交通事故"===d[i].PName&&(a.doneTotal["車輛及交通事故"]+=1)):r+=1,"路樹災情"===d[i].PName&&(a.total["路樹災情"]+=1),"民生、基礎設施災情"===d[i].PName&&(a.total["民生、基礎設施災情"]+=1),"建物毀損"===d[i].PName&&(a.total["建物毀損"]+=1),"廣告招牌災情"===d[i].PName&&(a.total["廣告招牌災情"]+=1),"積淹水災情"===d[i].PName&&(a.total["積淹水災情"]+=1),"其他災情"===d[i].PName&&(a.total["其他災情"]+=1),"土石災情"===d[i].PName&&(a.total["土石災情"]+=1),"道路、隧道災情"===d[i].PName&&(a.total["道路、隧道災情"]+=1),"水利設施災害"===d[i].PName&&(a.total["水利設施災情"]+=1),"鐵路、高鐵及捷運災情"===d[i].PName&&(a.total["鐵路、高鐵及捷運災情"]+=1),"車輛及交通事故"===d[i].PName&&(a.total["車輛及交通事故"]+=1);c=100*s/(s+r),a.caseDone=s,a.caseInProgress=r,a.caseRate=c.toFixed(2);new MarkerClusterer(a.map,a.markers,{gridSize:80,maxZoom:16})}).error(function(e,a,o,t){console.log("http error")}),t.get("https://tcgbusfs.blob.core.windows.net/blobfs/GetDisasterDecisionSummary.json").success(function(e,o,t,n){a.decisions=e.DataSet["diffgr:diffgram"].NewDataSet.DCSDisasterDecision}).error(function(e,a,o,t){console.log("http error")}),a.itemClicked=function(e,o){google.maps.event.trigger(a.markers[o],"click")}}])}();
//# sourceMappingURL=all.min.js.map